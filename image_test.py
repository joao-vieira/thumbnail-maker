from server import app
import time

def test_get_resized_image():
    base64const = "iVBORw0KGgoAAAANSUhEUgAAABIAAAAPCAIAAABm5AhFAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAA6SURBVDhPY/hPFhiS2hgYCIsAwcA6kkhADW1YfY8M4ArQteHSiSaFrggijRVAVYABdrMJAnpq+/8fAFBw9CiMWfoDAAAAAElFTkSuQmCC"
    base64result = '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'
    response_image = app.test_client().post("/image", data=dict(image=base64const))
    assert response_image.json == {"result":"success"}

    #Wait for image to be processed
    time.sleep(2)

    response_result = app.test_client().get("/result")
    assert response_result.text == base64result